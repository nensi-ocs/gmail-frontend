// ** MUI Imports
import Box from '@mui/material/Box'
import { useRouter } from 'next/router'
import { useContext, useState } from 'react'

// ** Icon Imports
import Icon from 'src/@core/components/icon'
import IconButton from '@mui/material/IconButton'
import useMediaQuery from '@mui/material/useMediaQuery'
import Menu from '@mui/material/Menu'
import MenuItem from '@mui/material/MenuItem'
import Divider from '@mui/material/Divider'

// ** Components
import UserDropdown from 'src/@core/layouts/components/shared-components/UserDropdown'
import { AuthContext } from 'src/context/AuthContext'
import API from 'src/utils/api'

const AppBarContent = props => {
  const isSmallScreen = useMediaQuery(theme => theme.breakpoints.down('md'))
  
  // ** Props
  const { settings } = props
  const { setPricing, setIsLoading } = useContext(AuthContext)
  const [menuAnchor, setMenuAnchor] = useState(null)
  const router = useRouter()

  const handlePricing = async () => {
    setIsLoading(true)
    try {
      const response = await API.subscriptionPrice()
      setPricing(response.data)
    } catch (error) {
      console.error('Error fetching pricing data:', error)
    } finally {
      setIsLoading(false)
    }
    await router.push('/pricing')
  }

  const handleHome = async () => {
    await router.push('/home')
  }

  const handleDash = async () => {
    await router.push('/dash')
  }

  const handleMenuOpen = event => {
    setMenuAnchor(event.currentTarget)
  }

  const handleMenuClose = () => {
    setMenuAnchor(null)
  }

  return (
    <>
      <Box sx={{ width: '100%', display: 'flex', alignItems: 'center', }}>
        <Box sx={{ paddingRight: '10px' }}>
          <button
            style={{
              border: 'none',
              background: 'none',
              color: 'rgba(47, 43, 61, 0.78)',
              cursor: 'pointer',
              width: '155px'
            }}
            onClick={handleHome}
          >
            <svg viewBox='28.384 66.048 719.433 153.93' xmlns='http://www.w3.org/2000/svg' width='100%'>
              <defs />
              <path
                opacity={1}
                stroke='none'
                d='M 491.301 381.222 C 331.968 381.222 173.134 381.222 14.301 381.222 C 14.301 247.889 14.301 114.556 14.301 -18.778 C 280.968 -18.778 547.634 -18.778 814.301 -18.778 C 814.301 114.556 814.301 247.889 814.301 381.222 C 706.801 381.222 599.301 381.222 491.301 381.222 M 202.276 105.007 C 204.188 101.153 206.215 97.35 207.98 93.429 C 209.726 89.549 208.743 88.624 204.538 88.452 C 198.452 88.203 192.316 87.82 186.329 86.771 C 174.978 84.781 165.124 86.989 158.865 97.138 C 154.556 104.126 151.737 112.023 148.043 119.41 C 147.191 121.116 145.544 123.615 144.165 123.68 C 131.902 124.26 119.403 125.908 107.39 124.24 C 92.172 122.125 77.071 120.315 61.782 121.383 C 55.23 121.84 48.676 123.426 42.321 125.208 C 37.355 126.601 36.925 129.259 40.976 132.508 C 43.491 134.526 46.662 135.916 49.749 136.977 C 53.073 138.12 55.121 140.044 57.167 142.947 C 60.445 147.598 64.67 151.603 68.649 155.732 C 74.277 161.574 80.299 167.058 85.643 173.143 C 88.113 175.955 89.376 179.826 91.439 183.691 C 84.473 185.749 78.648 187.707 72.701 189.177 C 61.272 192.002 49.728 194.375 38.339 197.349 C 35.787 198.016 33.68 200.388 31.369 201.975 C 33.708 203.472 36.02 205.014 38.404 206.436 C 39.091 206.847 39.969 206.997 40.782 207.127 C 53.366 209.134 65.953 211.117 79.299 213.288 C 81.402 213.663 83.494 214.128 85.611 214.399 C 110.81 217.627 134.701 213.414 156.194 199.801 C 190.578 178.023 202.935 145.012 202.276 105.007 M 359.93 178.153 C 362.108 185.019 365.944 188.918 373.986 187.629 C 377.135 187.124 378.969 186.521 380.397 183.531 C 385.921 171.973 391.725 160.549 397.44 149.083 C 398.517 146.92 399.661 144.791 400.774 142.647 C 401.172 142.733 401.571 142.818 401.97 142.904 C 401.97 161.885 401.97 180.866 401.97 199.949 C 408.06 199.949 413.461 199.949 418.97 199.949 C 418.97 170.127 418.97 140.588 418.97 110.569 C 413.388 110.569 408.085 110.75 402.803 110.5 C 399.644 110.351 398.144 111.561 396.812 114.374 C 389.405 130.011 381.774 145.542 374.196 161.098 C 373.455 162.62 372.56 164.066 371.423 166.109 C 370.153 163.645 369.222 161.914 368.358 160.15 C 360.891 144.91 353.47 129.646 345.921 114.447 C 345.187 112.969 343.736 110.85 342.514 110.777 C 336.272 110.404 329.995 110.605 323.83 110.605 C 323.83 140.885 323.83 170.439 323.83 199.908 C 329.604 199.908 335.008 199.908 340.99 199.908 C 340.99 180.616 340.99 161.638 340.99 142.66 C 341.338 142.587 341.686 142.514 342.034 142.441 C 347.875 154.129 353.716 165.817 359.93 178.153 M 641.452 133.744 C 642.623 133.12 643.735 132.328 644.973 131.898 C 651.563 129.609 658.25 129.18 664.002 133.613 C 668.691 137.227 669.661 142.664 668.948 149.063 C 660.249 149.063 651.731 148.404 643.372 149.276 C 636.9 149.95 630.234 151.704 624.361 154.475 C 615.744 158.54 612.104 166.506 612.373 175.865 C 612.647 185.379 616.62 193.424 625.731 196.938 C 631.917 199.324 638.91 200.433 645.574 200.573 C 655.835 200.788 663.942 195.621 670.42 186.402 C 671.193 190.148 671.58 192.904 672.385 195.533 C 672.752 196.734 673.9 198.564 674.766 198.605 C 680.488 198.881 686.23 198.748 692.136 198.748 C 692.136 180.696 692.138 163.55 692.133 146.403 C 692.133 145.071 692.172 143.732 692.05 142.409 C 691.371 135.097 689.136 128.463 683.854 123.061 C 668.645 107.509 636.882 107.986 622.257 124.118 C 617.932 128.888 615.279 134.452 615.041 141.548 C 618.448 141.548 621.418 141.453 624.379 141.567 C 631.105 141.827 638.068 142.732 641.452 133.744 M 435.851 133.331 C 423.651 156.718 432.315 184.696 455.437 196.577 C 477.748 208.04 505.869 199.164 517.325 176.616 C 513.274 175.139 509.195 173.859 505.296 172.164 C 502.407 170.907 500.535 171.261 498.52 173.851 C 494.278 179.302 488.568 182.827 481.723 183.738 C 474.915 184.644 467.986 184.971 460.962 180.265 C 470.077 171.249 478.704 162.754 487.287 154.215 C 495.998 145.549 504.666 136.839 513.428 128.073 C 512.766 127.077 512.373 126.359 511.864 125.737 C 492.8 102.467 454.007 102.622 435.851 133.331 M 595.384 191.82 C 599.747 187.145 604.11 182.471 609.174 177.045 C 603.693 175.061 599.464 173.701 595.383 171.989 C 592.838 170.922 591.266 171.285 589.393 173.438 C 587.135 176.034 584.48 178.462 581.573 180.285 C 572.859 185.751 558.883 185.663 552.155 180.187 C 553.39 178.867 554.574 177.529 555.834 176.267 C 570.775 161.311 585.642 146.28 600.747 131.492 C 603.744 128.557 603.649 126.766 600.864 123.897 C 587.831 110.47 572.077 105.945 554.363 111.075 C 535.577 116.515 524.369 129.695 521.354 149.091 C 518.458 167.731 527.604 185.819 544.099 195.546 C 559.54 204.652 579.746 203.338 595.384 191.82 M 254.735 110.032 C 244.806 111.734 236.718 116.635 230.368 124.359 C 221.474 135.18 219.004 147.906 220.398 161.415 C 224.515 201.287 265.39 210.214 289.2 194.674 C 304.18 184.896 308.947 169.979 308.523 152.782 C 307.806 123.762 284.259 104.581 254.735 110.032 M 735.488 147.722 C 735.488 137.307 735.488 126.892 735.488 116.613 C 728.562 116.613 722.343 116.613 716.21 116.613 C 716.21 145.265 716.21 173.527 716.21 201.926 C 722.71 201.926 728.946 201.926 735.488 201.926 C 735.488 183.995 735.488 166.359 735.488 147.722 M 707.175 85.928 C 707.463 88.54 707.297 91.305 708.119 93.736 C 711.166 102.745 720.661 108.032 729.412 105.911 C 738.897 103.613 745.175 95.056 744.265 85.668 C 743.381 76.549 735.737 69.365 726.661 69.124 C 716.106 68.844 708.771 74.85 707.175 85.928 Z'
                style={{
                  fill: 'none',
                  fillOpacity: 0
                }}
              />
              <path
                fill='#E5AB27'
                opacity={1}
                stroke='none'
                d='M 78.54 213.106 C 65.953 211.117 53.366 209.134 40.782 207.127 C 39.969 206.997 39.091 206.847 38.404 206.436 C 36.02 205.014 33.708 203.472 31.369 201.975 C 33.68 200.388 35.787 198.016 38.339 197.349 C 49.728 194.375 61.272 192.002 72.701 189.177 C 78.648 187.707 84.473 185.749 91.439 183.691 C 89.376 179.826 88.113 175.955 85.643 173.143 C 80.299 167.058 74.277 161.574 68.649 155.732 C 64.67 151.603 60.445 147.598 57.167 142.947 C 55.121 140.044 53.073 138.12 49.749 136.977 C 46.662 135.916 43.491 134.526 40.976 132.508 C 36.925 129.259 37.355 126.601 42.321 125.208 C 48.676 123.426 55.23 121.84 61.782 121.383 C 77.071 120.315 92.172 122.125 107.39 124.24 C 119.403 125.908 131.902 124.26 144.165 123.68 C 145.544 123.615 147.191 121.116 148.043 119.41 C 151.737 112.023 154.556 104.126 158.865 97.138 C 165.124 86.989 174.978 84.781 186.329 86.771 C 192.316 87.82 198.452 88.203 204.538 88.452 C 208.743 88.624 209.726 89.549 207.98 93.429 C 206.215 97.35 204.188 101.153 201.937 105.541 C 197.17 116.202 192.226 126.141 188.442 136.503 C 183.623 149.699 178.188 162.383 168.853 173.126 C 152.163 192.333 130.138 201.638 106.08 207.183 C 96.931 209.292 87.722 211.139 78.54 213.106 Z'
              />
              <path
                fill='#0574B0'
                opacity={1}
                stroke='none'
                d='M 359.744 177.829 C 353.716 165.817 347.875 154.129 342.034 142.441 C 341.686 142.514 341.338 142.587 340.99 142.66 C 340.99 161.638 340.99 180.616 340.99 199.908 C 335.008 199.908 329.604 199.908 323.83 199.908 C 323.83 170.439 323.83 140.885 323.83 110.605 C 329.995 110.605 336.272 110.404 342.514 110.777 C 343.736 110.85 345.187 112.969 345.921 114.447 C 353.47 129.646 360.891 144.91 368.358 160.15 C 369.222 161.914 370.153 163.645 371.423 166.109 C 372.56 164.066 373.455 162.62 374.196 161.098 C 381.774 145.542 389.405 130.011 396.812 114.374 C 398.144 111.561 399.644 110.351 402.803 110.5 C 408.085 110.75 413.388 110.569 418.97 110.569 C 418.97 140.588 418.97 170.127 418.97 199.949 C 413.461 199.949 408.06 199.949 401.97 199.949 C 401.97 180.866 401.97 161.885 401.97 142.904 C 401.571 142.818 401.172 142.733 400.774 142.647 C 399.661 144.791 398.517 146.92 397.44 149.083 C 391.725 160.549 385.921 171.973 380.397 183.531 C 378.969 186.521 377.135 187.124 373.986 187.629 C 365.944 188.918 362.108 185.019 359.744 177.829 Z'
              />
              <path
                fill='#0473B0'
                opacity={1}
                stroke='none'
                d='M 641.156 133.98 C 638.068 142.732 631.105 141.827 624.379 141.567 C 621.418 141.453 618.448 141.548 615.041 141.548 C 615.279 134.452 617.932 128.888 622.257 124.118 C 636.882 107.986 668.645 107.509 683.854 123.061 C 689.136 128.463 691.371 135.097 692.05 142.409 C 692.172 143.732 692.133 145.071 692.133 146.403 C 692.138 163.55 692.136 180.696 692.136 198.748 C 686.23 198.748 680.488 198.881 674.766 198.605 C 673.9 198.564 672.752 196.734 672.385 195.533 C 671.58 192.904 671.193 190.148 670.42 186.402 C 663.942 195.621 655.835 200.788 645.574 200.573 C 638.91 200.433 631.917 199.324 625.731 196.938 C 616.62 193.424 612.647 185.379 612.373 175.865 C 612.104 166.506 615.744 158.54 624.361 154.475 C 630.234 151.704 636.9 149.95 643.372 149.276 C 651.731 148.404 660.249 149.063 668.948 149.063 C 669.661 142.664 668.691 137.227 664.002 133.613 C 658.25 129.18 651.563 129.609 644.973 131.898 C 643.735 132.328 642.623 133.12 641.156 133.98 M 667.111 169.296 C 667.523 167.413 667.935 165.531 668.404 163.384 C 660.235 163.384 652.594 162.997 645.014 163.515 C 639.592 163.885 636.593 167.781 636.449 172.842 C 636.293 178.309 639.037 181.622 644.79 182.911 C 654.068 184.99 662.068 180.321 667.111 169.296 Z'
              />
              <path
                fill='#0473B0'
                opacity={1}
                stroke='none'
                d='M 436.03 133.008 C 454.007 102.622 492.8 102.467 511.864 125.737 C 512.373 126.359 512.766 127.077 513.428 128.073 C 504.666 136.839 495.998 145.549 487.287 154.215 C 478.704 162.754 470.077 171.249 460.962 180.265 C 467.986 184.971 474.915 184.644 481.723 183.738 C 488.568 182.827 494.278 179.302 498.52 173.851 C 500.535 171.261 502.407 170.907 505.296 172.164 C 509.195 173.859 513.274 175.139 517.325 176.616 C 505.869 199.164 477.748 208.04 455.437 196.577 C 432.315 184.696 423.651 156.718 436.03 133.008 M 478.288 139.709 C 481.69 136.143 485.092 132.577 488.592 128.908 C 478.103 123.638 462.948 127.171 455.375 135.595 C 447.59 144.256 444.829 158.971 450.396 167.799 C 459.602 158.526 468.695 149.367 478.288 139.709 Z'
              />
              <path
                fill='#0473B0'
                opacity={1}
                stroke='none'
                d='M 595.096 192.033 C 579.746 203.338 559.54 204.652 544.099 195.546 C 527.604 185.819 518.458 167.731 521.354 149.091 C 524.369 129.695 535.577 116.515 554.363 111.075 C 572.077 105.945 587.831 110.47 600.864 123.897 C 603.649 126.766 603.744 128.557 600.747 131.492 C 585.642 146.28 570.775 161.311 555.834 176.267 C 554.574 177.529 553.39 178.867 552.155 180.187 C 558.883 185.663 572.859 185.751 581.573 180.285 C 584.48 178.462 587.135 176.034 589.393 173.438 C 591.266 171.285 592.838 170.922 595.383 171.989 C 599.464 173.701 603.693 175.061 609.174 177.045 C 604.11 182.471 599.747 187.145 595.096 192.033 M 545.127 136.582 C 537.309 145.828 536.889 156.232 539.569 166.52 C 552.681 153.968 565.773 141.435 578.936 128.833 C 569.313 123.454 555.041 126.65 545.127 136.582 Z'
              />
              <path
                fill='#0473B0'
                opacity={1}
                stroke='none'
                d='M 255.16 109.925 C 284.259 104.581 307.806 123.762 308.523 152.782 C 308.947 169.979 304.18 184.896 289.2 194.674 C 265.39 210.214 224.515 201.287 220.398 161.415 C 219.004 147.906 221.474 135.18 230.368 124.359 C 236.718 116.635 244.806 111.734 255.16 109.925 M 269.187 186.043 C 280.102 183.88 286.793 177.178 289.739 166.638 C 291.942 158.757 291.873 150.817 289.429 142.993 C 285.281 129.716 273.795 122.735 260.037 124.997 C 246.975 127.144 239.476 135.503 237.767 150.587 C 235.609 169.622 245.112 188.347 269.187 186.043 Z'
              />
              <path
                fill='#0573AE'
                opacity={1}
                stroke='none'
                d='M 78.919 213.197 C 87.722 211.139 96.931 209.292 106.08 207.183 C 130.138 201.638 152.163 192.333 168.853 173.126 C 178.188 162.383 183.623 149.699 188.442 136.503 C 192.226 126.141 197.17 116.202 201.863 105.936 C 202.935 145.012 190.578 178.023 156.194 199.801 C 134.701 213.414 110.81 217.627 85.611 214.399 C 83.494 214.128 81.402 213.663 78.919 213.197 Z'
              />
              <path
                fill='#0071AF'
                opacity={1}
                stroke='none'
                d='M 735.488 148.222 C 735.488 166.359 735.488 183.995 735.488 201.926 C 728.946 201.926 722.71 201.926 716.21 201.926 C 716.21 173.527 716.21 145.265 716.21 116.613 C 722.343 116.613 728.562 116.613 735.488 116.613 C 735.488 126.892 735.488 137.307 735.488 148.222 Z'
              />
              <path
                fill='#E5AC29'
                opacity={1}
                stroke='none'
                d='M 707.193 85.489 C 708.771 74.85 716.106 68.844 726.661 69.124 C 735.737 69.365 743.381 76.549 744.265 85.668 C 745.175 95.056 738.897 103.613 729.412 105.911 C 720.661 108.032 711.166 102.745 708.119 93.736 C 707.297 91.305 707.463 88.54 707.193 85.489 M 731.08 94.731 C 734.723 90.585 735.537 86.182 732.992 82.664 C 730.59 79.343 727.394 77.523 723.134 78.968 C 717.952 80.726 715.416 85.492 717.083 90.21 C 719.116 95.963 723.781 97.695 731.08 94.731 Z'
              />
              <ellipse
                style={{
                  stroke: 'rgb(4, 115, 176)',
                  paintOrder: 'stroke',
                  fill: 'rgb(4, 115, 176)'
                }}
                cx={186.337}
                cy={99.331}
                rx={3.751}
                ry={4.22}
              />
              <ellipse
                style={{
                  fill: 'rgb(216, 216, 216)',
                  stroke: 'rgb(0, 0, 0)'
                }}
              />
            </svg>
          </button>
        </Box>
        {!isSmallScreen ? (
          <Box sx={{ width: '100%', display: 'flex', alignItems: 'center', justifyContent: 'space-between'}}>
            <Box className='actions-left' sx={{ mr: 5, display: 'flex', alignItems: 'center' }}>
              <Icon icon='tabler:home' sx={{ mt: -0.625 }} />
              <Box>
                <button
                  style={{
                    fontSize: '17px',
                    border: 'none',
                    background: 'none',
                    color: 'rgba(47, 43, 61, 0.78)',
                    padding: '0px',
                    cursor: 'pointer',
                    marginRight: '7px',
                    marginLeft: '3px',
                    ':hover': {
                      cursor: 'pointer',
                      backgroundColor: 'rgba(241, 245, 249, 1)',
                      borderRadius: '1.5em'
                    }
                  }}
                  onClick={handleHome}
                >
                  Home
                </button>
              </Box>
              <Icon icon='tabler:layout-dashboard' sx={{ mt: -0.25 }} />
              <Box>
                <button
                  style={{
                    fontSize: '17px',
                    border: 'none',
                    background: 'none',
                    color: 'rgba(47, 43, 61, 0.78)',
                    cursor: 'pointer',
                    padding: '0px',
                    marginRight: '7px',
                    marginLeft: '3px',
                    ':hover': {
                      cursor: 'pointer',
                      backgroundColor: 'rgba(241, 245, 249, 1)',
                      borderRadius: '1.5em'
                    }
                  }}
                  onClick={handleDash}
                >
                  Dash
                </button>
              </Box>
              <Icon icon='tabler:currency-dollar' sx={{ mt: -0.625 }} />
              <Box>
                <button
                  style={{
                    fontSize: '17px',
                    border: 'none',
                    background: 'none',
                    color: 'rgba(47, 43, 61, 0.78)',
                    cursor: 'pointer',
                    padding: '0px',
                    ':hover': {
                      cursor: 'pointer',
                      backgroundColor: 'rgba(241, 245, 249, 1)',
                      borderRadius: '1.5em'
                    }
                  }}
                  onClick={handlePricing}
                >
                  Pricing
                </button>
              </Box>
            </Box>
            <Box className='actions-right' sx={{ display: 'flex', alignItems: 'center', justifyContent: 'right' }}>
              <UserDropdown settings={settings} />
            </Box>
          </Box>
        ) : (
          <Box sx={{ width: '100%', display: 'flex', alignItems: 'center', justifyContent: 'right'}}>
            <IconButton color='inherit' onClick={handleMenuOpen}>
              <Icon fontSize='1.5rem' icon='tabler:menu-2' />
            </IconButton>
            <Menu
              anchorEl={menuAnchor}
              open={Boolean(menuAnchor)}
              onClose={handleMenuClose}
              sx={{
                '& .MuiPaper-root': {
                  width: '93%',
                  top: '90px !important',
                  left: {
                    xs: '15px !important', // left position for screens smaller than 600px
                    sm: '24px !important' // left position for screens larger than 600px
                  }
                }
              }}
            >
              <MenuItem
                onClick={() => {
                  handleHome()
                  handleMenuClose()
                }}
              >
                Home
              </MenuItem>
              <Divider sx={{ my: theme => `${theme.spacing(2)} !important` }} />
              <MenuItem
                onClick={() => {
                  handleDash()
                  handleMenuClose()
                }}
              >
                Dash
              </MenuItem>
              <Divider sx={{ my: theme => `${theme.spacing(2)} !important` }} />
              <MenuItem
                onClick={() => {
                  handlePricing()
                  handleMenuClose()
                }}
              >
                Pricing
              </MenuItem>
              <Divider sx={{ my: theme => `${theme.spacing(2)} !important` }} />
              <Box sx={{ p: 2, display: 'flex', justifyContent: 'left', textAlign: 'center' }}>
                <UserDropdown settings={settings} />
              </Box>
            </Menu>
          </Box>
        )}
      </Box>
    </>
  )
}

export default AppBarContent
